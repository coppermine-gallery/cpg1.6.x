<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<head>
<title>Coding guidelines - Developer documentation - Coppermine Photo Gallery - Documentation &amp; Manual</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="language" content="en" />
<meta name="copyright" content="Coppermine dev team" />
<meta name="description" content="This part of the documentation is not meant for end users of Coppermine, but only for developers. There is no support for this section, it comes as-is." />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta name="MSSmartTagsPreventParsing" content="true" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="robots" content="noindex" />
<!--
  SVN version info:
  Coppermine version: 1.6.01
  $HeadURL$
  $Revision$
-->
<link rel="stylesheet" type="text/css" href="../style/style.css" media="all" />
<link rel="stylesheet" type="text/css" href="../style/screen.css" media="screen" />
<link rel="stylesheet" type="text/css" href="../style/print.css" media="print" />
<link rel="shortcut icon" href="../favicon.ico" />
<script src="../js/jquery.js" type="text/javascript"></script>
<script src="../js/jquery.treeview.js" type="text/javascript"></script>
<script src="script.js" type="text/javascript"></script>
</head>
<body>
<h1 id="docheader">Coppermine Photo Gallery v1.5.x: Documentation and Manual</h1>
<div id="toc">
<a href="toc.htm">Table of Contents</a>
</div>

<div id="doc_en_only">No translation available</div>

<a name="dev_coding"></a><h1>Coding guidelines<a href="#dev_coding" title="Link to this section"><img src="images/anchor.gif" width="15" height="9" border="0" alt="" /></a></h1>

<a name="dev_coding_target_audience"></a><h2>Target audience<a href="#dev_coding_target_audience" title="Link to this section"><img src="images/anchor.gif" width="15" height="9" border="0" alt="" /></a></h2>
<p>This part of the documentation is not meant for end users of Coppermine, but only for developers. There is no support for this section, it comes as-is.</p>
<p>End users who wish to modify their copy of coppermine are encouraged to stick to these guidelines as well.</p>

<a name="dev_coding_scope"></a><h2>Scope<a href="#dev_coding_scope" title="Link to this section"><img src="images/anchor.gif" width="15" height="9" border="0" alt="" /></a></h2>
<p>As Coppermine is a team effort, the team members who contribute code need to make sure that the code remains easy to read, understand and maintain. That's why there is a set of rules defined on this page that should be taken into account when working with the coppermine core code. Although this part of the documentation is aimed at dev team members, users who plan to contribute their code in any form are requested to respect the rules as well if possible (i.e. if you understand them fully).</p>
<p>The coding guidelines on this page are not set in stone - if you (as a dev team member) find during development that one of the guidelines needs review or change, start a thread on the dev board for discussion.</p>

<hr />

<a name="dev_coding_indentation"></a><h2>Indentation<a href="#dev_coding_indentation" title="Link to this section"><img src="images/anchor.gif" width="15" height="9" border="0" alt="" /></a></h2>
<ul>
    <li>Use an indent of 4 spaces, with no tabs. Most editors can be configured to do this.</li>
    <li>Don't be afraid to use blank lines between logical "sections" of code, but don't use too many because it makes it too spaced out</li>
</ul>

<hr />

<a name="dev_coding_general"></a><h2>General guidelines<a href="#dev_coding_general" title="Link to this section"><img src="images/anchor.gif" width="15" height="9" border="0" alt="" /></a></h2>
<ul>
    <li>In queries or code, always have spaces before and after operators</li>
</ul>

<hr />

<a name="dev_coding_php"></a><h2>PHP code<a href="#dev_coding_php" title="Link to this section"><img src="images/anchor.gif" width="15" height="9" border="0" alt="" /></a></h2>

<a name="dev_coding_formatting"></a><h3>Formatting<a href="#dev_coding_formatting" title="Link to this section"><img src="images/anchor.gif" width="15" height="9" border="0" alt="" /></a></h3>

<ul>
    <li>Equals sign should be aligned with surrounding elements<br />
    <div class="cpg_example">
        Bad example:
        <pre class="code">
$pic_title = 'My picture';
$album = 'lastup';
$update_time = true;
        </pre>
        Good Example:
        <pre class="code">
$pic_title   = 'My picture';
$album       = 'lastup';
$update_time = true;
        </pre>
    </div>
    </li>
    <li>Array with multiple values cannot be declared on a single line. However if there is only one value then it can be declared in same line</li>
    <li>Always put comma after last value in array declaration</li>
    <li>Always allign array double arrow in a single line and there should be a single space after the arrow (before value)</li>
    <li>Each line in an array declaration must end in a comma<br />
    <div class="cpg_example">
        Bad examples:
        <pre class="code">
$foo = array('one', 'two', 'three');

$bar = array(
'one' => 1, 'two' => 3,
'three' => 3
);

$multi = array('first' => 'one', 'second' => array('2'), 'third' => array('foo' => 'bar', 'hello' => 'world'));
        </pre>
        Good Examples:
        <pre class="code">
$foo = array(
        'one',
        'two',
        'three',
       );

$bar = array(
        'one'   => 1,
        'two'   => 2,
        'three' => 3,
       );
       
$multi = array(
          'first'  => 'one',
          'second' => array('2'), // Since it is just one value in array, it can be declared in same line
          'third'  => array(
                       'foo'   => 'bar',
                       'hello' => 'world',
                      ),
         );
        </pre>
    </div>
    </li>
    <li>Use <tt class="code">echo</tt> instead of <tt class="code">print</tt></li>
    <li>Use single quotes instead of double quotes
    	<div class="cpg_example">
    		Bad:
    		<pre class="code">$foo_array["bla"] = "whatever";</pre>
    		Good:
    		<pre class="code">$foo_array['bla'] = 'whatever';</pre>
    	</div>
    </li>
    <li>Don't use spaces or capitalization in associative array definitions
    	<div class="cpg_example">
    		Bad:
    		<pre class="code">$bla_array['foo Bar'] = 'some string';</pre>
    		Good:
    		<pre class="code">$bla_array['foo_bar'] = 'some string';</pre>
    	</div>    
    </li>
</ul>

<a name="dev_coding_control_structures"></a><h3>Control Structures<a href="#dev_coding_control_structures" title="Link to this section"><img src="images/anchor.gif" width="15" height="9" border="0" alt="" /></a></h3>
<p>These include <tt class="code">if</tt>, <tt class="code">for</tt>, <tt class="code">while</tt>, <tt class="code">switch</tt>.</p>
<ul>
    <li>Control statements should have one space between the control keyword and opening parenthesis, to distinguish them from function calls</li>
    <li>Always use curly braces, even in situations where they are technically optional - having them increases readability and decreases the likelihood of logic errors being introduced when new lines are added</li>
    <li>Always have a newline before an opening or closing brace<br />
    <div class="cpg_example">Bad example:<pre class="code">if ($foo = 'bar') { echo 'Hello world'; }</pre>Bad example:<pre class="code">if ($foo = 'bar') 
{ echo 'Hello world'; }</pre>Good example:<pre class="code">if ($foo = 'bar') { 
    echo 'Hello world'; 
}</pre>Good example:<pre class="code">if ($foo = 'bar')
{ 
    echo 'Hello world'; 
}</pre></div></li>
</ul>

<a name="dev_coding_function_calls"></a><h3>Function Calls<a href="#dev_coding_function_calls" title="Link to this section"><img src="images/anchor.gif" width="15" height="9" border="0" alt="" /></a></h3>
<ul>
    <li>Functions should be called with no spaces between the function name, the opening parenthesis, and the first parameter, spaces between commas and each parameter, and no space between the last parameter, the  closing parenthesis, and the semicolon.</li>
    <li>There should be one space on either side of an equals sign used to assign the return value of a function to a variable. In the case of a block of related assignments, more space may be inserted to promote readability.</li>
</ul>

<a name="dev_coding_function_definitions"></a><h3>Function Definitions<a href="#dev_coding_function_definitions" title="Link to this section"><img src="images/anchor.gif" width="15" height="9" border="0" alt="" /></a></h3>
<ul>
    <li>Function definitions follow the "one true brace" convention:<pre class="code">&lt;?php
    
    
function fooFunction($arg1, $arg2 = '')
{
    if (condition) {
        statement;
    }
    return $val;
}


?&gt;</pre></li>
    <li>Arguments with default values must be at the end of the argument list</li>
    <li>There should be two blank lines above and below the function declration</li>
    <li>Do not use functions that do not exist in PHP4.3 or lower (and don't use functions that have been removed later either!) unless you define them for those versions.</li>
</ul>

<a name="dev_coding_php_tags"></a><h3>PHP Code Tags<a href="#dev_coding_php_tags" title="Link to this section"><img src="images/anchor.gif" width="15" height="9" border="0" alt="" /></a></h3>
<ul>
    <li>Always use <tt class="code">&lt;?php ?&gt;</tt> to delimit PHP code, not the <tt class="code">&lt;? ?&gt;</tt> shorthand, as the long version will work on all server setups, but the short version might not work everywhere.</li>
</ul>

<a name="dev_coding_html_nesting"></a><h3>Nesting of HTML in PHP<a href="#dev_coding_html_nesting" title="Link to this section"><img src="images/anchor.gif" width="15" height="9" border="0" alt="" /></a></h3>
<p>When more than one line of HTML needs to be printed, the <a href="http://www.php.net/manual/en/language.types.string.php#language.types.string.syntax.heredoc" rel="external" class="phpnet">heredoc syntax</a> should be used instead of ending the PHP processing and starting it later.</p>
<div class="cpg_example">
<p>Good:</p>
<pre class="code">// PHP content here
if ($foo == $bar) {
	print &lt;&lt;&lt; EOT
	&lt;h1&gt;Hello {$bla}&lt;/h1&gt;
EOT;
}</pre>
<p>Bad:</p>
<pre class="code">// PHP content here
if ($foo == $bar) {
	?&gt;
	&lt;h1&gt;Hello &lt;?php echo $bla; ?&gt;&lt;/h1&gt;
&lt;?php
}</pre>
</div>
<hr />

<a name="dev_coding_linebreaks"></a><h3>Line breaks<a href="#dev_coding_linebreaks" title="Link to this section"><img src="images/anchor.gif" width="15" height="9" border="0" alt="" /></a></h3>
<p>To echo line breaks to the HTML output, use the <a href="http://www.php.net/manual/en/language.types.string.php#language.types.string.syntax.heredoc" rel="external" class="phpnet">heredoc syntax</a> or use the variable <tt class="code">$LINEBREAK</tt> instead of hardcoding line breaks into the code.</p>
<p>Remember to make the variable global inside functions.</p>
<div class="cpg_example">
<p>Good:</p>
<pre class="code">echo '&lt;h1&gt;Hello world&lt;/h1&gt;' . $LINEBREAK;
echo '&lt;p&gt;foo bar&lt;/p&gt;';
}</pre>
<p>Bad:</p>
<pre class="code">echo "&lt;h1&gt;Hello world&lt;/h1&gt;\n";
echo '&lt;p&gt;foo bar&lt;/p&gt;';
}</pre>
</div> 

<hr />

<a name="dev_coding_naming_conventions"></a><h3>Naming Conventions<a href="#dev_coding_naming_conventions" title="Link to this section"><img src="images/anchor.gif" width="15" height="9" border="0" alt="" /></a></h3>
<ul>
    <li><strong>Functions</strong> should always be named in lowercase and using the underscore notation eg: <tt class="code">function_name()</tt></li>
    <li><strong>Variables</strong> also follow the same conventions (lowercase and using the underscore notation), however globally accessed variables should be UPPERCASE (eg: <tt class="code">$CONFIG</tt>)</li>
    <li>Superglobals (e.g. $_GET or $_POST) need to be sanitized using Inspekt - refer to the section &quot;<a href="dev_superglobals.htm#superglobals_sanitization">Sanitization of Superglobals using Inspekt</a>&quot;</li>
    <li><strong>Constants</strong> should be defined in UPPERCASE with underscore separation of words</li>
    <li><strong>Filenames</strong> should also follow the same underscore convention and be all lowercase</li>
    <li>As always, descriptive names (for folders/files/functions/variables/constants) are much better than "$egYtesIopnfer" type ones. (except when using counters, $i, etc.)</li>
</ul>

<hr />

<a name="dev_coding_database"></a><h2>Database queries<a href="#dev_coding_database" title="Link to this section"><img src="images/anchor.gif" width="15" height="9" border="0" alt="" /></a></h2>
<ul>
    <li>Always free MySQL result resources. (as well as other resources!)</li>
    <li>In queries, always capitalize commands: <tt class="code">SELECT</tt>, <tt class="code">INSERT</tt>, <tt class="code">REPLACE</tt>, <tt class="code">UPDATE</tt>, <tt class="code">DELETE</tt>, etc. should be all uppercase</li>
    <li>In queries, always capitalize <tt class="code">WHERE</tt>, <tt class="code">AND</tt>, <tt class="code">OR</tt>, <tt class="code">LIMIT</tt>, <tt class="code">FROM</tt>, <tt class="code">JOIN</tt>, <tt class="code">AS</tt>, <tt class="code">ON</tt>, etc.</li>
    <li>Avoid field names that are also keywords in MySQL</li>
    <li>Do not use any features of MySQL not available in MySQL 3.23.4 and lower</li>
    <li>Optimize all queries for MySQL 4, although they as above should work in lower</li>
    <li>Keep all id attributes unique, and try to keep id and name the same if both are specified</li>
    <li>Use <tt class="code">LIMIT</tt> for queries whenever possible</li>
    <li><tt class="code">LEFT JOIN</tt>s are slower than regular <tt class="code">JOIN</tt>s (or commas) so they should be avoided if possible</li>
    <li>It's not <tt class="code">messages as m</tt>, but <tt class="code">messages AS m</tt>, because <tt class="code">AS</tt> is a MySQL keyword</li>
    <li>When doing a <tt class="code">JOIN</tt>, the joined table's column(s) come first in the <tt class="code">ON</tt> clause</li>
</ul>

<hr />

<a name="dev_coding_documentation"></a><h2>Documentation<a href="#dev_coding_documentation" title="Link to this section"><img src="images/anchor.gif" width="15" height="9" border="0" alt="" /></a></h2>
<ul>
    <li>Keep correct inline documentation at the tops of files</li>
    <li>Keep the documentation/comments at the tops of files limited to a width of 80 characters</li>
    <li>Start each comment line with a capital letter, and use proper grammar. (periods at the end and all!)</li> 
    <li>There is a sub-section of the developer documentation that deals with <a href="dev_documentation.htm">editing the documentation</a> - please pay attention to it</li>
    <li>There are special steps required when <a href="dev_config.htm">adding a config option</a> - please pay attention to the corresponding section of the docs.
</ul>

<hr />

<a name="dev_coding_html_output"></a><h2>HTML output<a href="#dev_coding_html_output" title="Link to this section"><img src="images/anchor.gif" width="15" height="9" border="0" alt="" /></a></h2>
<ul>
    <li>Always close input, img, hr, and other elements that can't contain anything. (<tt class="code">&lt;tagname <strong>/</strong>&gt;</tt>)</li>
    <li>Coppermine is aimed to be web standards compliant, so you should always try to come up with output that qualifies as valid HTML and CSS. Especially the output that the gallery visitor (and the search engine spiders) see should clearly be valid; output that only the admin will see can be less strict (although you should <em>try</em> to come up with valid output for the admin as well). There is one exception to this standards-compliance rule: if standards-compliant code breaks core functionality for major browsers like the current implementation of object embedding that is not standards compliant because of IE5.x &quot; misbehaving&quot; in standards-compliant mode, it is acceptable to create output that doesn't validate. If this is the case, make sure to at least make others aware of this (<a href="known_issues.htm">known issues</a> section of the docs is the best place,  but at least add some comment to the code).</li>
    <li>Make sure that there are no unescaped <tt class="code">&amp;</tt>-signs (ampersands) in the HTML output. Ampersands must always be escaped as <tt class="code">&amp;amp;</tt>.</li>
    <li><tt class="code">&lt;</tt> and <tt class="code">&gt;</tt>-signs that are meant to be actually displayed in the output (that do not compose tags) must be encoded as <tt class="code">&amp;lt;</tt> and <tt class="code">&amp;gt;</tt></li>
</ul>

<a name="dev_coding_html_output_images"></a><h3>Image-tags in HTML output<a href="#dev_coding_html_output_images" title="Link to this section"><img src="images/anchor.gif" width="15" height="9" border="0" alt="" /></a></h3>
<ul>
    <li>Always put an alt attribute on all image elements, even if the alt is empty</li>
    <li>The border attribute is mandatory - if ommitted, older browsers will display a border by default</li>
    <li>If possible (i.e. if the dimension of an image is known already), use the width and height attributes</li>
    <li>do not use title for the purpose of alt, only use it when a title is needed (like for icons)</li>
    <li>If you need a blind gif, use the one that already comes with coppermine (<tt class="code">./images/spacer.gif</tt>) instead of coming up with a new one for your custom theme, plugin or whatever</li>
</ul>

<a name="dev_coding_html_output_links"></a><h3>Links in HTML output<a href="#dev_coding_html_output_dev_coding_html_output_links" title="Link to this section"><img src="images/anchor.gif" width="15" height="9" border="0" alt="" /></a></h3>
<ul>
    <li>Never use the target attribute at all, it's invalid. Use <tt class="code">&lt;a href="http://example.com/" rel="external" class="external"&gt;</tt> instead. The end user can then easily use JavaScript to make external links open in a new window if he wishes to do so.</li>
</ul>

<a name="dev_coding_html_output_form"></a><h3>Form elements in HTML output<a href="#dev_coding_html_output_form" title="Link to this section"><img src="images/anchor.gif" width="15" height="9" border="0" alt="" /></a></h3>
<ul>
    <li>
        It is mandatory to use particular CSS classes for certain form elements:
        <ul>
            <li><tt class="code">&lt;input type="text" class="textinput" /&gt;</tt></li>
            <li><tt class="code">&lt;input type="submit" class="button" /&gt;</tt></li>
            <li><tt class="code">&lt;input type="radio" class="radio" /&gt;</tt></li>
            <li><tt class="code">&lt;input type="checkbox" class="checkbox" /&gt;</tt></li>
            <li><tt class="code">&lt;select class="listbox" /&gt;</tt></li>
        </ul>
    </li>
</ul>

<a name="dev_coding_html_output_deprecated"></a><h3>Deprecated tags<a href="#dev_coding_html_output_deprecated" title="Link to this section"><img src="images/anchor.gif" width="15" height="9" border="0" alt="" /></a></h3>
<p>Deprecated HTML tags like <tt class="code">&lt;font&gt;</tt> mustn't be introduced into Coppermine unless there is a valid, documented reason to do so.</p>

<a name="dev_coding_html_prefered_tags"></a><h3>Prefered tags<a href="#dev_coding_html_prefered_tags" title="Link to this section"><img src="images/anchor.gif" width="15" height="9" border="0" alt="" /></a></h3>
<p>The popular tags <tt class="code">&lt;b&gt;</tt> and <tt class="code">&lt;i&gt;</tt> are considered to be deprecated tags as well. Because of their popularity, browsers will probably support them for a long time. However, there are better alternatives. For <tt class="code">&lt;b&gt;</tt>, the replacement tag is <tt class="code">&lt;strong&gt;</tt>. For <tt class="code">&lt;i&gt;</tt>, the replacement tag is <tt class="code">&lt;em&gt;</tt>. If possible, the replacement tags should be used both in HTML output generated by Coppermine as well as the documentation.</p>

<hr />

<a name="dev_coding_credits"></a><h2>Credits for coding guidelines<a href="#dev_coding_credits" title="Link to this section"><img src="images/anchor.gif" width="15" height="9" border="0" alt="" /></a></h2>
<p>The core rules on this page have been sketched by Dr. Tarique Sani as a subset of the PEAR coding guidelines. HTML output and database sections are based on a thread created by Unknown W. Brackets from <a href="http://www.simplemachines.org/" rel="external" class="external">Simplemachines</a>.</p>


<div id="doc_footer">
	<div class="doc_info_wrapper">
		<span id="doc_last_changed">$LastChangedDate$</span>
		<span id="doc_revision">$Revision$</span>
	</div>
</div>
</body>
</html>